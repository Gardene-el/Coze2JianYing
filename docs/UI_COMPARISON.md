# UI 结构变化对比

## 改进前的 UI 结构

### 主窗口
```
┌────────────────────────────────────────────────────────┐
│ Coze剪映草稿生成器                                      │
├────────────────────────────────────────────────────────┤
│ 菜单栏: 文件 | 帮助                                     │
├────────────────────────────────────────────────────────┤
│                                                        │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 标签页 1: 云端服务                              │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 草稿文件夹设置:                                 │  │ ← 重复1
│  │ [路径] [选择文件夹] [自动检测]                  │  │
│  │                                                 │  │
│  │ FastAPI 服务管理...                             │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 标签页 2: 脚本执行                              │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 输出设置:                                       │  │ ← 重复2
│  │ [路径] [选择文件夹] [自动检测]                  │  │
│  │                                                 │  │
│  │ 脚本内容...                                     │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 标签页 3: 手动草稿生成                          │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 输出设置:                                       │  │ ← 重复3
│  │ [路径] [选择文件夹] [自动检测]                  │  │
│  │                                                 │  │
│  │ 输入内容...                                     │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
├────────────────────────────────────────────────────────┤
│ 日志窗口                                               │
└────────────────────────────────────────────────────────┘
```

**问题**:
- ❌ 三个标签页各自管理路径，配置分散
- ❌ UI 重复，用户需要在每个标签页单独设置
- ❌ 切换标签页时路径可能不一致
- ❌ 无法统一管理存储方案

## 改进后的 UI 结构

### 主窗口
```
┌────────────────────────────────────────────────────────┐
│ Coze剪映草稿生成器                                      │
├────────────────────────────────────────────────────────┤
│ 菜单栏: 文件 | 帮助                                     │
├────────────────────────────────────────────────────────┤
│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓ │
│ ┃ 草稿文件夹设置 (全局)                   ← 新增！  ┃ │
│ ┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫ │
│ ┃ 剪映草稿文件夹:                                   ┃ │
│ ┃ [C:\Users\...\draft] [选择文件夹] [自动检测]      ┃ │
│ ┃                                                   ┃ │
│ ┃ ☑ 传输草稿到指定文件夹                   ← 新增！ ┃ │
│ ┃ (勾选后草稿将保存在上方指定的文件夹中...)          ┃ │
│ ┃                                                   ┃ │
│ ┃ • 勾选: 草稿直接保存在剪映文件夹，               ┃ │
│ ┃        素材存储在 CozeJianYingAssistantAssets    ┃ │
│ ┃ • 不勾选: 草稿和素材保存在本地数据目录            ┃ │
│ ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛ │
├────────────────────────────────────────────────────────┤
│                                                        │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 标签页 1: 云端服务                              │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ FastAPI 服务管理...               ← 简化！      │  │
│  │                                                 │  │
│  │ (路径设置已移除，使用全局配置)                  │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 标签页 2: 脚本执行                              │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 脚本内容...                       ← 简化！      │  │
│  │                                                 │  │
│  │ (路径设置已移除，使用全局配置)                  │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
│  ┌─────────────────────────────────────────────────┐  │
│  │ 标签页 3: 手动草稿生成                          │  │
│  ├─────────────────────────────────────────────────┤  │
│  │ 输入内容...                       ← 简化！      │  │
│  │                                                 │  │
│  │ (路径设置已移除，使用全局配置)                  │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
├────────────────────────────────────────────────────────┤
│ 日志窗口                                               │
└────────────────────────────────────────────────────────┘
```

**改进**:
- ✅ 统一的全局配置面板，位于主窗口顶部
- ✅ 所有标签页共享配置，无需重复设置
- ✅ 清晰的说明文字，用户易于理解
- ✅ 两种存储方案一目了然
- ✅ 标签页界面更简洁，专注核心功能

## 配置流程对比

### 改进前
```
用户操作流程:
1. 打开应用
2. 切换到"云端服务"标签页
3. 设置草稿文件夹路径
4. 切换到"脚本执行"标签页
5. 再次设置草稿文件夹路径 ← 重复！
6. 切换到"手动草稿生成"标签页
7. 又要设置草稿文件夹路径 ← 重复！
8. 开始使用...

问题: 需要在3个地方重复设置相同的路径
```

### 改进后
```
用户操作流程:
1. 打开应用
2. 在主窗口顶部一次性设置:
   - 选择或自动检测草稿文件夹路径
   - 决定是否勾选"传输到草稿文件夹"
3. 切换到任意标签页，直接使用 ← 配置全局生效！

优势: 只需设置一次，所有标签页自动使用
```

## 代码结构对比

### 改进前
```
每个标签页独立管理:
- draft_generator_tab.py: output_folder
- cloud_service_tab.py: output_folder  
- script_executor_tab.py: output_folder

问题:
- 配置分散，难以同步
- 代码重复，维护困难
- 用户体验不一致
```

### 改进后
```
全局统一管理:
- draft_config_manager.py: DraftConfigManager (单例)
  ├── draft_folder_path (全局变量)
  └── transfer_to_draft_folder (全局变量)

所有模块共享:
- draft_generator_tab.py  ─┐
- cloud_service_tab.py     ├─→ get_draft_config_manager()
- script_executor_tab.py   ─┤
- draft_saver.py          ─┘

优势:
- 配置集中，易于管理
- 代码复用，减少冗余
- 用户体验一致
```

## 功能增强对比

| 功能 | 改进前 | 改进后 |
|-----|-------|-------|
| 路径设置位置 | 每个标签页独立 | 主窗口顶部统一 |
| 配置同步 | 需手动同步 | 自动全局生效 |
| 存储方案选择 | 无法选择 | 一键切换两种方案 |
| 用户操作步骤 | 3次设置路径 | 1次设置路径 |
| 界面简洁度 | 较复杂 | 更简洁 |
| 代码维护性 | 分散难维护 | 集中易维护 |

## 存储方案可视化

### 方案一：传输到草稿文件夹（勾选时）

```
文件系统结构:

C:\Users\用户名\AppData\Local\JianyingPro\User Data\Projects\com.lveditor.draft\
├── 我的草稿1\                           ← 草稿文件
│   ├── draft_content.json
│   ├── draft_info.json
│   └── draft_meta_info.json
├── 我的草稿2\
│   └── ...
├── CozeJianYingAssistantAssets\         ← 素材文件夹
│   ├── {draft_id_1}\                    ← 按草稿ID分组
│   │   ├── video1.mp4
│   │   ├── audio1.mp3
│   │   └── image1.jpg
│   └── {draft_id_2}\
│       └── ...
└── 其他草稿...

特点:
✓ 剪映直接可见草稿
✓ 素材集中管理
✓ 适合手动编辑场景
```

### 方案二：本地数据目录（不勾选时）

```
文件系统结构:

C:\Users\用户名\AppData\Local\coze2jianying_data\
├── drafts\                              ← 草稿目录
│   ├── 我的草稿1\
│   │   ├── draft_content.json
│   │   ├── draft_info.json
│   │   └── draft_meta_info.json
│   └── 我的草稿2\
│       └── ...
├── assets\                              ← 素材目录
│   ├── {draft_id_1}\
│   │   ├── video1.mp4
│   │   ├── audio1.mp3
│   │   └── image1.jpg
│   └── {draft_id_2}\
│       └── ...
└── cache\                               ← 缓存目录
    └── ...

特点:
✓ 独立的数据目录
✓ 不干扰剪映
✓ 适合批量生成和API调用
```

## 总结

这次 UI 改进实现了：

1. **🎯 用户体验提升**
   - 从"需要设置3次"到"只需设置1次"
   - 从"配置分散"到"统一管理"
   - 从"不知道存哪"到"清晰可选"

2. **🏗️ 代码质量提升**
   - 从"代码重复"到"单一职责"
   - 从"难以维护"到"易于扩展"
   - 从"配置混乱"到"全局统一"

3. **✨ 功能增强**
   - 新增两种存储方案切换
   - 新增路径自动检测
   - 新增清晰的使用说明

这是一次成功的 UI/UX 改进，在简化操作的同时增强了功能！
