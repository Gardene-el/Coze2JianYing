# æ‰‹åŠ¨å¯¼å…¥é—®é¢˜åˆ†æä¸å¤šç§è§£å†³æ–¹æ¡ˆ

## é—®é¢˜èƒŒæ™¯

### å½“å‰æ‰‹åŠ¨å¯¼å…¥æµç¨‹

```
Coze äº‘ç«¯ â†’ ç”Ÿæˆ JSON æ•°æ® â†’ ç”¨æˆ·å¤åˆ¶ç²˜è´´ â†’ è‰ç¨¿ç”Ÿæˆå™¨ GUI â†’ ç”Ÿæˆå‰ªæ˜ è‰ç¨¿
```

**é—®é¢˜ç‚¹**ï¼š
1. ç»´æŠ¤æˆæœ¬é«˜ï¼šéœ€è¦ç»´æŠ¤è‡ªå®šä¹‰çš„ JSON æ•°æ®ç»“æ„
2. æ‰‹åŠ¨æ“ä½œï¼šéœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¤åˆ¶ç²˜è´´ JSON æ•°æ®
3. é”™è¯¯é£é™©ï¼šæ‰‹åŠ¨æ“ä½œå®¹æ˜“å‡ºé”™

## å½“å‰é¡¹ç›®æ¶æ„åˆ†æ

### ä¸‰ç§å·²æœ‰çš„å·¥ä½œæ¨¡å¼

#### 1. æ‰‹åŠ¨è‰ç¨¿ç”Ÿæˆæ¨¡å¼ï¼ˆ"æ‰‹åŠ¨è‰ç¨¿ç”Ÿæˆ"æ ‡ç­¾é¡µï¼‰

**å·¥ä½œæµç¨‹**ï¼š
```
Coze æ’ä»¶ â†’ å¯¼å‡º JSON â†’ ç”¨æˆ·æ‰‹åŠ¨å¤åˆ¶ â†’ ç²˜è´´åˆ° GUI â†’ ç”Ÿæˆè‰ç¨¿
```

**ç‰¹ç‚¹**ï¼š
- âœ… æ— éœ€ç½‘ç»œè¿æ¥
- âœ… å®Œå…¨ç¦»çº¿å·¥ä½œ
- âœ… æ•°æ®å®‰å…¨ï¼ˆä¸ç»è¿‡å…¬ç½‘ï¼‰
- âŒ éœ€è¦æ‰‹åŠ¨å¤åˆ¶ç²˜è´´
- âŒ ç»´æŠ¤è‡ªå®šä¹‰ JSON ç»“æ„

**é€‚ç”¨åœºæ™¯**ï¼š
- ç½‘ç»œä¸ç¨³å®šæˆ–æ— ç½‘ç»œç¯å¢ƒ
- å¯¹æ•°æ®å®‰å…¨æœ‰ä¸¥æ ¼è¦æ±‚
- å¶å°”ä½¿ç”¨ï¼Œä¸éœ€è¦è‡ªåŠ¨åŒ–

#### 2. äº‘ç«¯æœåŠ¡æ¨¡å¼ï¼ˆ"äº‘ç«¯æœåŠ¡"æ ‡ç­¾é¡µï¼‰

**å·¥ä½œæµç¨‹**ï¼š
```
Coze å·¥ä½œæµ â†’ HTTP API è°ƒç”¨ â†’ FastAPI æœåŠ¡ â†’ ç”Ÿæˆè‰ç¨¿
```

**ç‰¹ç‚¹**ï¼š
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
- âœ… æ”¯æŒæµå¼å¤„ç†ï¼Œè¾¹ç”Ÿæˆè¾¹ä¼ è¾“
- âœ… ä½¿ç”¨æ ‡å‡† HTTP APIï¼Œæ— éœ€ç»´æŠ¤è‡ªå®šä¹‰æ ¼å¼
- âš ï¸ éœ€è¦å…¬ç½‘è®¿é—®ï¼ˆå¯é€šè¿‡ ngrok å®ç°ï¼‰
- âš ï¸ éœ€è¦ä¿æŒæœåŠ¡è¿è¡Œ

**é€‚ç”¨åœºæ™¯**ï¼š
- é¢‘ç¹ä½¿ç”¨
- éœ€è¦è‡ªåŠ¨åŒ–å·¥ä½œæµ
- æœ‰å…¬ç½‘è®¿é—®æ¡ä»¶ï¼ˆæœ¬åœ°æˆ–è¿œç¨‹æœåŠ¡å™¨ï¼‰

#### 3. æœ¬åœ°æœåŠ¡æ¨¡å¼ï¼ˆ"æœ¬åœ°æœåŠ¡"æ ‡ç­¾é¡µ - å·²åºŸå¼ƒï¼‰

**çŠ¶æ€**ï¼šç»è°ƒæŸ¥ï¼ŒCoze Workflow ä¸æ”¯æŒç«¯ä¾§æ’ä»¶ï¼Œæ­¤æ¨¡å¼ä¸å¯ç”¨

## ç”¨æˆ·æå‡ºçš„è„šæœ¬æ–¹æ¡ˆåˆ†æ

### æ–¹æ¡ˆæè¿°

```
Coze äº‘ç«¯ â†’ ç”Ÿæˆ Python è„šæœ¬ â†’ ç”¨æˆ·å¤åˆ¶è„šæœ¬ â†’ æœ¬åœ°æ‰§è¡Œè„šæœ¬ â†’ è°ƒç”¨ API â†’ ç”Ÿæˆè‰ç¨¿
```

### å¯è¡Œæ€§åˆ†æ

**æŠ€æœ¯ä¸Šå¯è¡Œ**ï¼Œä½†éœ€è¦è€ƒè™‘ï¼š

#### ä¼˜ç‚¹
1. âœ… åŠè‡ªåŠ¨åŒ–ï¼šåªéœ€å¤åˆ¶è„šæœ¬è€Œé JSON æ•°æ®
2. âœ… çµæ´»æ€§ï¼šè„šæœ¬å¯ä»¥åŒ…å«é€»è¾‘å’Œé”™è¯¯å¤„ç†
3. âœ… å¯æ‰©å±•ï¼šè„šæœ¬å¯ä»¥æ‰§è¡Œé¢å¤–æ“ä½œ

#### ç¼ºç‚¹
1. âŒ **ä»éœ€æ‰‹åŠ¨æ“ä½œ**ï¼šå¤åˆ¶è„šæœ¬ â†’ æ‰§è¡Œè„šæœ¬
2. âŒ **å¢åŠ å¤æ‚åº¦**ï¼šéœ€è¦ç»´æŠ¤è„šæœ¬ç”Ÿæˆé€»è¾‘
3. âŒ **å®‰å…¨é£é™©**ï¼šæ‰§è¡ŒæœªçŸ¥è„šæœ¬æœ‰å®‰å…¨éšæ‚£
4. âŒ **ä¾èµ–é—®é¢˜**ï¼šéœ€è¦ Python ç¯å¢ƒå’Œä¾èµ–åŒ…
5. âŒ **è°ƒè¯•å›°éš¾**ï¼šè„šæœ¬å‡ºé”™éš¾ä»¥å®šä½

### ä¸ç°æœ‰æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ‰‹åŠ¨ JSON | è„šæœ¬æ–¹æ¡ˆ | äº‘ç«¯ API |
|------|----------|----------|----------|
| è‡ªåŠ¨åŒ–ç¨‹åº¦ | âŒ å®Œå…¨æ‰‹åŠ¨ | âš ï¸ åŠè‡ªåŠ¨ | âœ… å…¨è‡ªåŠ¨ |
| ç»´æŠ¤æˆæœ¬ | é«˜ | ä¸­ç­‰ | ä½ |
| ä½¿ç”¨å¤æ‚åº¦ | ç®€å• | ä¸­ç­‰ | ç®€å• |
| å®‰å…¨æ€§ | âœ… é«˜ | âš ï¸ ä¸­ç­‰ | âš ï¸ ä¸­ç­‰ |
| ç½‘ç»œéœ€æ±‚ | âŒ æ—  | âŒ æ—  | âœ… éœ€è¦ |
| é”™è¯¯å¤„ç† | åŸºæœ¬ | å¯å®šåˆ¶ | å®Œå–„ |

## æ¨èçš„è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼šä¼˜å…ˆä½¿ç”¨äº‘ç«¯æœåŠ¡æ¨¡å¼ï¼ˆæ¨èï¼‰

**ä¸ºä»€ä¹ˆæ¨è**ï¼š
1. âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
2. âœ… ç»´æŠ¤æˆæœ¬æœ€ä½ï¼Œä½¿ç”¨æ ‡å‡† HTTP API
3. âœ… å®æ—¶åé¦ˆï¼Œé”™è¯¯å¤„ç†å®Œå–„
4. âœ… é¡¹ç›®å·²å®Œæ•´å®ç°ï¼Œç›´æ¥å¯ç”¨

**å®æ–½æ­¥éª¤**ï¼š

1. **å¯åŠ¨ FastAPI æœåŠ¡**ï¼š
   - æ‰“å¼€è‰ç¨¿ç”Ÿæˆå™¨åº”ç”¨
   - åˆ‡æ¢åˆ°"äº‘ç«¯æœåŠ¡"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"å¯åŠ¨æœåŠ¡"

2. **é…ç½® ngrokï¼ˆå¦‚éœ€å…¬ç½‘è®¿é—®ï¼‰**ï¼š
   - åœ¨ [ngrok.com](https://ngrok.com) æ³¨å†Œè´¦å·
   - è·å– authtoken
   - åœ¨"äº‘ç«¯æœåŠ¡"æ ‡ç­¾é¡µé…ç½® authtoken
   - ç‚¹å‡»"å¯åŠ¨ ngrok"

3. **åœ¨ Coze ä¸­é…ç½®æ’ä»¶**ï¼š
   - åˆ›å»º"äº‘ä¾§æ’ä»¶ - åŸºäºå·²æœ‰æœåŠ¡"
   - é…ç½® API ç«¯ç‚¹ï¼ˆæœ¬åœ°åœ°å€æˆ– ngrok å…¬ç½‘åœ°å€ï¼‰
   - ä½¿ç”¨ OpenAPI è§„èŒƒå®šä¹‰æ¥å£

4. **åœ¨å·¥ä½œæµä¸­ä½¿ç”¨**ï¼š
   - ç›´æ¥è°ƒç”¨é…ç½®å¥½çš„æ’ä»¶
   - å·¥ä½œæµè‡ªåŠ¨é€šè¿‡ HTTP è°ƒç”¨æœ¬åœ°æœåŠ¡
   - è‰ç¨¿è‡ªåŠ¨ç”Ÿæˆ

**å‚è€ƒæ–‡æ¡£**ï¼š
- `API_QUICKSTART.md` - API å¿«é€Ÿå¼€å§‹æŒ‡å—
- `docs/API_DESIGN.md` - API è®¾è®¡æ–‡æ¡£
- `docs/NGROK_INTEGRATION_README.md` - ngrok é…ç½®æŒ‡å—

### æ–¹æ¡ˆ Bï¼šæ”¹è¿›æ‰‹åŠ¨å¯¼å…¥æµç¨‹ï¼ˆæ¬¡é€‰ï¼‰

å¦‚æœæ— æ³•ä½¿ç”¨äº‘ç«¯æœåŠ¡ï¼ˆæ— å…¬ç½‘è®¿é—®ï¼‰ï¼Œå¯ä»¥æ”¹è¿›ç°æœ‰æ‰‹åŠ¨æµç¨‹ï¼š

#### B1. ç®€åŒ– JSON æ ¼å¼

**é—®é¢˜**ï¼šå½“å‰ JSON æ ¼å¼å¤æ‚ï¼Œç»´æŠ¤æˆæœ¬é«˜

**è§£å†³**ï¼š
1. æä¾› JSON æ¨¡æ¿å’ŒéªŒè¯å·¥å…·
2. æ·»åŠ  JSON æ ¼å¼åŒ–å·¥å…·ï¼ˆå·²æœ‰ï¼š`scripts/coze_json_formatter.py`ï¼‰
3. åœ¨ GUI ä¸­æ·»åŠ  JSON éªŒè¯å’Œé”™è¯¯æç¤º

#### B2. æ–‡ä»¶æ‹–æ”¾æ”¯æŒ

**å½“å‰**ï¼šåªèƒ½ç²˜è´´æ–‡æœ¬

**æ”¹è¿›**ï¼š
- æ”¯æŒæ‹–æ”¾ JSON æ–‡ä»¶åˆ°çª—å£
- æ”¯æŒä»æ–‡ä»¶é€‰æ‹©å™¨å¯¼å…¥
- æ”¯æŒæ‰¹é‡å¯¼å…¥å¤šä¸ªæ–‡ä»¶

#### B3. å‰ªè´´æ¿ç›‘å¬

**åŠŸèƒ½**ï¼šè‡ªåŠ¨æ£€æµ‹å‰ªè´´æ¿ä¸­çš„ JSON æ•°æ®

**å®ç°**ï¼š
- åå°ç›‘å¬å‰ªè´´æ¿å˜åŒ–
- æ£€æµ‹åˆ°æœ‰æ•ˆ JSON æ—¶æç¤ºç”¨æˆ·
- ä¸€é”®å¯¼å…¥æ— éœ€æ‰‹åŠ¨ç²˜è´´

### æ–¹æ¡ˆ Cï¼šè„šæœ¬æ¨¡æ¿æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰

å¦‚æœç”¨æˆ·åšæŒä½¿ç”¨è„šæœ¬æ–¹æ¡ˆï¼Œå¯ä»¥æä¾›æ ‡å‡†åŒ–çš„è„šæœ¬æ¨¡æ¿ï¼š

#### è„šæœ¬æ¨¡æ¿ç¤ºä¾‹

```python
#!/usr/bin/env python3
"""
Coze2JianYing è‡ªåŠ¨è‰ç¨¿ç”Ÿæˆè„šæœ¬
ç”± Coze å·¥ä½œæµè‡ªåŠ¨ç”Ÿæˆï¼Œç”¨äºæœ¬åœ°æ‰§è¡Œ
"""
import requests
import json

# é…ç½®
API_BASE_URL = "http://127.0.0.1:8000"
OUTPUT_FOLDER = None  # None è¡¨ç¤ºä½¿ç”¨é»˜è®¤è·¯å¾„

# è‰ç¨¿æ•°æ®ï¼ˆç”± Coze ç”Ÿæˆï¼‰
DRAFT_DATA = {
    "draft_name": "ç¤ºä¾‹é¡¹ç›®",
    "width": 1920,
    "height": 1080,
    "fps": 30,
    "tracks": [
        # ... è½¨é“å’Œç‰‡æ®µæ•°æ®
    ]
}

def create_draft():
    """åˆ›å»ºè‰ç¨¿"""
    response = requests.post(
        f"{API_BASE_URL}/api/draft/create",
        json={
            "draft_name": DRAFT_DATA["draft_name"],
            "width": DRAFT_DATA["width"],
            "height": DRAFT_DATA["height"],
            "fps": DRAFT_DATA["fps"]
        }
    )
    response.raise_for_status()
    return response.json()["draft_id"]

def add_tracks(draft_id):
    """æ·»åŠ è½¨é“å’Œç‰‡æ®µ"""
    for track in DRAFT_DATA["tracks"]:
        # æ·»åŠ è½¨é“
        response = requests.post(
            f"{API_BASE_URL}/api/draft/{draft_id}/add_track",
            json={"track_type": track["track_type"]}
        )
        response.raise_for_status()
        
        # æ·»åŠ ç‰‡æ®µ
        for segment in track["segments"]:
            response = requests.post(
                f"{API_BASE_URL}/api/draft/{draft_id}/add_segment",
                json=segment
            )
            response.raise_for_status()

def save_draft(draft_id):
    """ä¿å­˜è‰ç¨¿"""
    response = requests.post(
        f"{API_BASE_URL}/api/draft/{draft_id}/save",
        json={"output_folder": OUTPUT_FOLDER}
    )
    response.raise_for_status()
    return response.json()

def main():
    """ä¸»æµç¨‹"""
    try:
        print("ğŸš€ å¼€å§‹ç”Ÿæˆè‰ç¨¿...")
        
        # 1. åˆ›å»ºè‰ç¨¿
        print("ğŸ“ åˆ›å»ºè‰ç¨¿...")
        draft_id = create_draft()
        print(f"âœ… è‰ç¨¿åˆ›å»ºæˆåŠŸ: {draft_id}")
        
        # 2. æ·»åŠ è½¨é“å’Œç‰‡æ®µ
        print("ğŸ¬ æ·»åŠ å†…å®¹...")
        add_tracks(draft_id)
        print("âœ… å†…å®¹æ·»åŠ æˆåŠŸ")
        
        # 3. ä¿å­˜è‰ç¨¿
        print("ğŸ’¾ ä¿å­˜è‰ç¨¿...")
        result = save_draft(draft_id)
        print(f"âœ… è‰ç¨¿ä¿å­˜æˆåŠŸ: {result['output_path']}")
        
        print("\\nğŸ‰ è‰ç¨¿ç”Ÿæˆå®Œæˆï¼")
        
    except requests.exceptions.ConnectionError:
        print("âŒ é”™è¯¯: æ— æ³•è¿æ¥åˆ° API æœåŠ¡")
        print("è¯·ç¡®ä¿è‰ç¨¿ç”Ÿæˆå™¨åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸” API æœåŠ¡å·²å¯åŠ¨")
    except requests.exceptions.HTTPError as e:
        print(f"âŒ API é”™è¯¯: {e}")
        print(f"å“åº”å†…å®¹: {e.response.text}")
    except Exception as e:
        print(f"âŒ æœªçŸ¥é”™è¯¯: {e}")

if __name__ == "__main__":
    main()
```

#### ä½¿ç”¨æ­¥éª¤

1. **åœ¨ Coze ä¸­ç”Ÿæˆè„šæœ¬**ï¼š
   - å·¥ä½œæµæœ€åä¸€æ­¥ç”Ÿæˆä¸Šè¿°è„šæœ¬
   - å°†è‰ç¨¿æ•°æ®å¡«å……åˆ° `DRAFT_DATA` å˜é‡

2. **ç”¨æˆ·æ‰§è¡Œ**ï¼š
   ```bash
   # ç¡®ä¿ API æœåŠ¡æ­£åœ¨è¿è¡Œ
   # ç„¶åæ‰§è¡Œè„šæœ¬
   python generated_script.py
   ```

3. **ä¾èµ–è¦æ±‚**ï¼š
   - Python 3.7+
   - requests åº“ï¼š`pip install requests`

#### è„šæœ¬æ–¹æ¡ˆçš„æ”¹è¿›

**æ·»åŠ è„šæœ¬æ‰§è¡Œå™¨åˆ° GUI**ï¼š

åœ¨è‰ç¨¿ç”Ÿæˆå™¨ä¸­æ·»åŠ æ–°æ ‡ç­¾é¡µ"è„šæœ¬æ‰§è¡Œ"ï¼š
- æä¾›è„šæœ¬è¾“å…¥æ¡†
- æ·»åŠ "æ‰§è¡Œè„šæœ¬"æŒ‰é’®
- åœ¨æ²™ç®±ç¯å¢ƒä¸­æ‰§è¡Œï¼ˆä½¿ç”¨ `subprocess` æˆ– `exec`ï¼‰
- æ˜¾ç¤ºæ‰§è¡Œç»“æœå’Œé”™è¯¯

**å®‰å…¨è€ƒè™‘**ï¼š
1. âš ï¸ è­¦å‘Šç”¨æˆ·è„šæœ¬æ‰§è¡Œé£é™©
2. æä¾›è„šæœ¬å®¡æŸ¥ç•Œé¢ï¼Œæ˜¾ç¤ºå°†è¦æ‰§è¡Œçš„ä»£ç 
3. é™åˆ¶è„šæœ¬æƒé™ï¼ˆç¦æ­¢æ–‡ä»¶ç³»ç»Ÿå†™å…¥ç­‰å±é™©æ“ä½œï¼‰
4. æä¾›"å®‰å…¨æ¨¡å¼"ä»…å…è®¸ API è°ƒç”¨

## å®æ–½å»ºè®®

### çŸ­æœŸæ–¹æ¡ˆï¼ˆç«‹å³å¯ç”¨ï¼‰

1. **å®Œå–„äº‘ç«¯æœåŠ¡æ–‡æ¡£**
   - æ·»åŠ è¯¦ç»†çš„é…ç½®æŒ‡å—
   - æä¾›è§†é¢‘æ•™ç¨‹
   - åˆ—å‡ºå¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ³•

2. **æ”¹è¿›æ‰‹åŠ¨å¯¼å…¥ä½“éªŒ**
   - æ·»åŠ æ–‡ä»¶æ‹–æ”¾æ”¯æŒ
   - æ”¹è¿›é”™è¯¯æç¤º
   - æä¾› JSON æ¨¡æ¿ä¸‹è½½

### ä¸­æœŸæ–¹æ¡ˆï¼ˆ1-2å‘¨ï¼‰

1. **æ·»åŠ è„šæœ¬æ¨¡æ¿ç”ŸæˆåŠŸèƒ½**
   - åœ¨ Coze æ’ä»¶ä¸­æ·»åŠ è„šæœ¬ç”Ÿæˆå·¥å…·
   - æä¾›æ ‡å‡†åŒ–çš„è„šæœ¬æ¨¡æ¿
   - ç”ŸæˆåŒ…å«æ•°æ®çš„å¯æ‰§è¡Œè„šæœ¬

2. **æ·»åŠ è„šæœ¬æ‰§è¡Œå™¨æ ‡ç­¾é¡µ**
   - GUI ä¸­æ·»åŠ è„šæœ¬æ‰§è¡Œç•Œé¢
   - å®ç°å®‰å…¨çš„è„šæœ¬æ‰§è¡Œç¯å¢ƒ
   - æä¾›æ‰§è¡Œç»“æœåé¦ˆ

### é•¿æœŸæ–¹æ¡ˆï¼ˆ1ä¸ªæœˆ+ï¼‰

1. **å¼€å‘ Coze å·¥ä½œæµç›´è¿æ–¹æ¡ˆ**
   - ç ”ç©¶ Coze Bot Chat æ¨¡å¼ï¼ˆæ”¯æŒç«¯ä¾§æ’ä»¶ï¼‰
   - å®ç° Bot ä¸æœ¬åœ°æœåŠ¡çš„å®æ—¶é€šä¿¡
   - æä¾›æ›´åŸç”Ÿçš„é›†æˆä½“éªŒ

2. **å¼€å‘æµè§ˆå™¨æ’ä»¶**
   - è‡ªåŠ¨æ•è· Coze è¾“å‡º
   - ä¸€é”®å‘é€åˆ°æœ¬åœ°æœåŠ¡
   - æ— éœ€æ‰‹åŠ¨å¤åˆ¶

## æŠ€æœ¯å®ç°ç»†èŠ‚

### è„šæœ¬æ‰§è¡Œå™¨å®ç°

å¦‚æœå†³å®šå®ç°è„šæœ¬æ‰§è¡Œå™¨ï¼Œéœ€è¦è€ƒè™‘ï¼š

#### å®‰å…¨æ‰§è¡Œç¯å¢ƒ

```python
import subprocess
import tempfile
import os

def execute_script_safely(script_content: str) -> dict:
    """
    åœ¨å—é™ç¯å¢ƒä¸­æ‰§è¡Œè„šæœ¬
    
    Args:
        script_content: è„šæœ¬å†…å®¹
        
    Returns:
        æ‰§è¡Œç»“æœå­—å…¸
    """
    # åˆ›å»ºä¸´æ—¶æ–‡ä»¶
    with tempfile.NamedTemporaryFile(
        mode='w', 
        suffix='.py', 
        delete=False
    ) as f:
        f.write(script_content)
        script_path = f.name
    
    try:
        # æ‰§è¡Œè„šæœ¬ï¼Œé™åˆ¶æƒé™
        result = subprocess.run(
            ['python', script_path],
            capture_output=True,
            text=True,
            timeout=300,  # 5åˆ†é’Ÿè¶…æ—¶
            env={
                'PYTHONPATH': os.getcwd(),
                'API_BASE_URL': 'http://127.0.0.1:8000'
            }
        )
        
        return {
            'success': result.returncode == 0,
            'stdout': result.stdout,
            'stderr': result.stderr,
            'returncode': result.returncode
        }
        
    finally:
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        os.unlink(script_path)
```

#### GUI è„šæœ¬æ‰§è¡Œæ ‡ç­¾é¡µ

```python
class ScriptExecutorTab(BaseTab):
    """è„šæœ¬æ‰§è¡Œæ ‡ç­¾é¡µ"""
    
    def __init__(self, parent, log_callback=None):
        super().__init__(parent, "è„šæœ¬æ‰§è¡Œ")
        self.log_callback = log_callback
    
    def _create_widgets(self):
        # è„šæœ¬è¾“å…¥åŒºåŸŸ
        self.script_frame = ttk.LabelFrame(
            self.frame, 
            text="Python è„šæœ¬", 
            padding="5"
        )
        
        self.script_text = scrolledtext.ScrolledText(
            self.script_frame,
            height=20,
            wrap=tk.WORD,
            font=("Consolas", 10)
        )
        
        # å®‰å…¨è­¦å‘Š
        self.warning_label = ttk.Label(
            self.frame,
            text="âš ï¸ è­¦å‘Šï¼šè¯·ä»”ç»†å®¡æŸ¥è„šæœ¬å†…å®¹ï¼Œç¡®ä¿æ¥æºå¯ä¿¡",
            foreground="red"
        )
        
        # æ‰§è¡ŒæŒ‰é’®
        self.execute_btn = ttk.Button(
            self.frame,
            text="æ‰§è¡Œè„šæœ¬",
            command=self._execute_script
        )
        
        # ç»“æœæ˜¾ç¤º
        self.result_frame = ttk.LabelFrame(
            self.frame,
            text="æ‰§è¡Œç»“æœ",
            padding="5"
        )
        
        self.result_text = scrolledtext.ScrolledText(
            self.result_frame,
            height=10,
            wrap=tk.WORD,
            font=("Consolas", 9),
            state=tk.DISABLED
        )
    
    def _execute_script(self):
        """æ‰§è¡Œè„šæœ¬"""
        script_content = self.script_text.get("1.0", tk.END)
        
        # ç¡®è®¤å¯¹è¯æ¡†
        if not messagebox.askyesno(
            "ç¡®è®¤æ‰§è¡Œ",
            "ç¡®å®šè¦æ‰§è¡Œæ­¤è„šæœ¬å—ï¼Ÿ\n\nè¯·ç¡®ä¿è„šæœ¬æ¥æºå¯ä¿¡ï¼Œ"
            "è„šæœ¬å¯èƒ½åŒ…å«å±é™©æ“ä½œã€‚"
        ):
            return
        
        # åœ¨åå°çº¿ç¨‹æ‰§è¡Œ
        threading.Thread(
            target=self._run_script,
            args=(script_content,),
            daemon=True
        ).start()
    
    def _run_script(self, script_content: str):
        """åœ¨åå°çº¿ç¨‹æ‰§è¡Œè„šæœ¬"""
        self.result_text.config(state=tk.NORMAL)
        self.result_text.delete("1.0", tk.END)
        self.result_text.insert("1.0", "ğŸš€ æ­£åœ¨æ‰§è¡Œè„šæœ¬...\\n\\n")
        self.result_text.config(state=tk.DISABLED)
        
        result = execute_script_safely(script_content)
        
        self.result_text.config(state=tk.NORMAL)
        self.result_text.delete("1.0", tk.END)
        
        if result['success']:
            self.result_text.insert("1.0", f"âœ… æ‰§è¡ŒæˆåŠŸ\\n\\n{result['stdout']}")
        else:
            self.result_text.insert(
                "1.0", 
                f"âŒ æ‰§è¡Œå¤±è´¥ (è¿”å›ç : {result['returncode']})\\n\\n"
                f"é”™è¯¯è¾“å‡º:\\n{result['stderr']}\\n\\n"
                f"æ ‡å‡†è¾“å‡º:\\n{result['stdout']}"
            )
        
        self.result_text.config(state=tk.DISABLED)
```

## æ€»ç»“ä¸å»ºè®®

### é’ˆå¯¹ç”¨æˆ·é—®é¢˜çš„ç›´æ¥å›ç­”

#### Q1: è„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆåšï¼Ÿ

**A**: è„šæœ¬æ˜¯åŒ…å«è‰ç¨¿æ•°æ®å’Œ API è°ƒç”¨é€»è¾‘çš„ Python æ–‡ä»¶ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç”Ÿæˆï¼š

1. **åœ¨ Coze æ’ä»¶ä¸­æ·»åŠ è„šæœ¬ç”Ÿæˆå·¥å…·**ï¼š
   - ä½¿ç”¨å­—ç¬¦ä¸²æ¨¡æ¿ç”Ÿæˆ Python è„šæœ¬
   - å°†è‰ç¨¿æ•°æ®åºåˆ—åŒ–ä¸º JSON åµŒå…¥è„šæœ¬
   - è¿”å›å®Œæ•´çš„å¯æ‰§è¡Œè„šæœ¬æ–‡æœ¬

2. **è„šæœ¬ç»“æ„**ï¼š
   - å¯¼å…¥å¿…éœ€çš„åº“ï¼ˆrequestsï¼‰
   - å®šä¹‰è‰ç¨¿æ•°æ®ï¼ˆä» Coze å·¥ä½œæµè·å–ï¼‰
   - å®ç° API è°ƒç”¨é€»è¾‘
   - é”™è¯¯å¤„ç†å’Œç»“æœè¾“å‡º

#### Q2: é¡¹ç›®è¦å¦‚ä½•æ‰§è¡Œè„šæœ¬ï¼Ÿ

**A**: æœ‰ä¸‰ç§æ–¹å¼ï¼š

1. **ç”¨æˆ·æ‰‹åŠ¨æ‰§è¡Œ**ï¼ˆæœ€ç®€å•ï¼‰ï¼š
   ```bash
   python generated_script.py
   ```
   éœ€è¦ï¼šPython ç¯å¢ƒ + requests åº“

2. **åœ¨ GUI ä¸­æ·»åŠ è„šæœ¬æ‰§è¡Œå™¨**ï¼ˆæ¨èï¼‰ï¼š
   - æ·»åŠ æ–°æ ‡ç­¾é¡µ"è„šæœ¬æ‰§è¡Œ"
   - ç”¨æˆ·ç²˜è´´è„šæœ¬
   - ç‚¹å‡»æŒ‰é’®æ‰§è¡Œ
   - æ˜¾ç¤ºæ‰§è¡Œç»“æœ

3. **è‡ªåŠ¨æ‰§è¡Œ**ï¼ˆå¤æ‚ï¼‰ï¼š
   - ç›‘å¬ç‰¹å®šæ–‡ä»¶å¤¹
   - è‡ªåŠ¨æ£€æµ‹æ–°è„šæœ¬
   - è‡ªåŠ¨æ‰§è¡Œå¹¶é€šçŸ¥

#### Q3: ä¼šä¸ä¼šéœ€è¦é¢å¤–çš„ä¾èµ–ï¼Ÿ

**A**: æ˜¯çš„ï¼Œä½†ä¾èµ–å¾ˆå°‘ï¼š

**å¿…éœ€ä¾èµ–**ï¼š
- Python 3.7+ ï¼ˆé€šå¸¸å·²å®‰è£…ï¼‰
- `requests` åº“ï¼š`pip install requests`

**å¯é€‰ä¾èµ–**ï¼š
- é¡¹ç›®å·²å®‰è£…çš„æ‰€æœ‰ä¾èµ–ï¼ˆå¦‚æœè„šæœ¬éœ€è¦è°ƒç”¨é¡¹ç›®åŠŸèƒ½ï¼‰

**é™ä½ä¾èµ–çš„æ–¹æ³•**ï¼š
- ä½¿ç”¨æ ‡å‡†åº“çš„ `urllib` æ›¿ä»£ `requests`
- å°†ä¾èµ–æ£€æŸ¥å’Œå®‰è£…é€»è¾‘å†…ç½®åˆ°è„šæœ¬ä¸­

#### Q4: é™¤äº†è„šæœ¬æ–¹æ¡ˆï¼Œæœ‰å…¶ä»–å»ºè®®å—ï¼Ÿ

**A**: æœ‰ï¼Œè€Œä¸”æˆ‘å¼ºçƒˆæ¨èä»¥ä¸‹æ–¹æ¡ˆï¼š

**æœ€ä½³æ–¹æ¡ˆï¼šç›´æ¥ä½¿ç”¨äº‘ç«¯æœåŠ¡æ¨¡å¼**
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€ä»»ä½•æ‰‹åŠ¨æ“ä½œ
- âœ… é¡¹ç›®å·²å®Œæ•´å®ç°ï¼Œç›´æ¥å¯ç”¨
- âœ… ç»´æŠ¤æˆæœ¬æœ€ä½
- âœ… é”™è¯¯å¤„ç†å®Œå–„

**åŸå› **ï¼š
1. è„šæœ¬æ–¹æ¡ˆæœ¬è´¨ä¸Šè¿˜æ˜¯"åŠè‡ªåŠ¨"ï¼Œä»éœ€æ‰‹åŠ¨å¤åˆ¶å’Œæ‰§è¡Œ
2. äº‘ç«¯ API æ¨¡å¼å·²ç»å®Œç¾è§£å†³äº†æ‰€æœ‰é—®é¢˜
3. è„šæœ¬æ–¹æ¡ˆå¢åŠ äº†ä¸å¿…è¦çš„å¤æ‚åº¦å’Œå®‰å…¨é£é™©

**å¦‚æœæ— æ³•ä½¿ç”¨äº‘ç«¯æœåŠ¡**ï¼ˆæ— å…¬ç½‘è®¿é—®ï¼‰ï¼Œå»ºè®®ï¼š
- æ”¹è¿›æ‰‹åŠ¨å¯¼å…¥ï¼šæ·»åŠ æ–‡ä»¶æ‹–æ”¾ã€å‰ªè´´æ¿ç›‘å¬
- ç®€åŒ– JSON æ ¼å¼ï¼šæä¾›æ¨¡æ¿å’ŒéªŒè¯å·¥å…·
- ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼šæ›´å¥½çš„é”™è¯¯æç¤ºå’ŒæŒ‡å¯¼

### æ¨èçš„è¡ŒåŠ¨æ–¹æ¡ˆ

**ç«‹å³é‡‡å–**ï¼š
1. âœ… ä½¿ç”¨äº‘ç«¯æœåŠ¡æ¨¡å¼ï¼ˆå¦‚æœå¯ä»¥ï¼‰
2. âœ… å®Œå–„äº‘ç«¯æœåŠ¡çš„æ–‡æ¡£å’Œæ•™ç¨‹
3. âœ… æ”¹è¿›æ‰‹åŠ¨å¯¼å…¥çš„ç”¨æˆ·ä½“éªŒ

**å¯é€‰å®æ–½**ï¼ˆå¦‚ç”¨æˆ·åšæŒéœ€è¦è„šæœ¬æ–¹æ¡ˆï¼‰ï¼š
1. åœ¨ Coze æ’ä»¶ä¸­æ·»åŠ è„šæœ¬ç”Ÿæˆå·¥å…·
2. åœ¨ GUI ä¸­æ·»åŠ è„šæœ¬æ‰§è¡Œå™¨æ ‡ç­¾é¡µ
3. æä¾›å®‰å…¨æ‰§è¡Œç¯å¢ƒå’Œé”™è¯¯å¤„ç†

**ä¸æ¨è**ï¼š
- âŒ å®Œå…¨æ›¿ä»£ç°æœ‰æ–¹æ¡ˆï¼šç°æœ‰æ–¹æ¡ˆå·²ç»å¾ˆå¥½
- âŒ è¿‡åº¦å¤æ‚åŒ–ï¼šè„šæœ¬æ–¹æ¡ˆå¢åŠ å¤æ‚åº¦
- âŒ å¿½ç•¥äº‘ç«¯æœåŠ¡ï¼šè¿™æ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆ

### ç»“è®º

**ç”¨æˆ·æå‡ºçš„è„šæœ¬æ–¹æ¡ˆåœ¨æŠ€æœ¯ä¸Šå¯è¡Œï¼Œä½†ä¸æ˜¯æœ€ä¼˜è§£**ã€‚

**æ¨èè·¯å¾„**ï¼š
1. **é¦–é€‰**ï¼šä½¿ç”¨äº‘ç«¯æœåŠ¡æ¨¡å¼ï¼ˆå®Œå…¨è‡ªåŠ¨åŒ–ï¼‰
2. **æ¬¡é€‰**ï¼šæ”¹è¿›æ‰‹åŠ¨å¯¼å…¥ä½“éªŒï¼ˆæ–‡ä»¶æ‹–æ”¾ã€å‰ªè´´æ¿ç›‘å¬ï¼‰
3. **å¯é€‰**ï¼šæä¾›è„šæœ¬æ¨¡æ¿ï¼ˆä½œä¸ºè¿‡æ¸¡æ–¹æ¡ˆï¼‰

**ç»´æŠ¤æˆæœ¬å¯¹æ¯”**ï¼š
- äº‘ç«¯ APIï¼šç»´æŠ¤æˆæœ¬æœ€ä½ï¼Œæ ‡å‡†åŒ–æ¥å£
- æ”¹è¿›æ‰‹åŠ¨å¯¼å…¥ï¼šä¸­ç­‰æˆæœ¬ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ
- è„šæœ¬æ–¹æ¡ˆï¼šè¾ƒé«˜æˆæœ¬ï¼Œéœ€è¦ç»´æŠ¤è„šæœ¬ç”Ÿæˆå’Œæ‰§è¡Œé€»è¾‘

**æœ€ç»ˆå»ºè®®**ï¼š
æŠ•å…¥ç²¾åŠ›å®Œå–„äº‘ç«¯æœåŠ¡çš„æ–‡æ¡£å’Œæ˜“ç”¨æ€§ï¼Œè€Œä¸æ˜¯å¼€å‘æ–°çš„è„šæœ¬æ‰§è¡Œæœºåˆ¶ã€‚è¿™æ ·èƒ½ä»¥æœ€å°çš„æˆæœ¬è¾¾åˆ°æœ€å¥½çš„æ•ˆæœã€‚
