# 脚本执行器标签页 - 界面展示

## 主界面布局

```
┌───────────────────────────────────────────────────────────────────────────┐
│  Coze剪映草稿生成器                                                  _ □ × │
├───────────────────────────────────────────────────────────────────────────┤
│  文件(F)  查看(V)  帮助(H)                                                │
├───────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────────────┐ │
│  │ [手动草稿生成] [云端服务] [本地服务] [脚本执行器*] [示例标签页]    │ │
│  ├─────────────────────────────────────────────────────────────────────┤ │
│  │                                                                       │ │
│  │  ┌─────────────────────────────────────────────────────────────┐   │ │
│  │  │ [加载脚本...] [清空] [执行脚本]                              │   │ │
│  │  └─────────────────────────────────────────────────────────────┘   │ │
│  │                                                                       │ │
│  │  ┌─ 脚本内容 ─────────────────────────────────────────────────┐   │ │
│  │  │                                                              │   │ │
│  │  │  # 创建草稿                                                  │   │ │
│  │  │  req = CreateDraftRequest(                                  │   │ │
│  │  │      draft_name="演示",                                      │   │ │
│  │  │      width=1920,                                             │   │ │
│  │  │      height=1080,                                            │   │ │
│  │  │      fps=30                                                  │   │ │
│  │  │  )                                                           │   │ │
│  │  │                                                              │   │ │
│  │  │  resp = await create_draft(req)                             │   │ │
│  │  │  draft_id = resp.draft_id                                   │   │ │
│  │  │                                                              │   │ │
│  │  │  print(f"✓ 草稿创建成功: {draft_id}")                       │   │ │
│  │  │                                                              │   │ │
│  │  │                                                            ▲ │   │ │
│  │  │                                                            █ │   │ │
│  │  │                                                            ▼ │   │ │
│  │  └──────────────────────────────────────────────────────────┘   │ │
│  │                                                                       │ │
│  │  ┌─ 执行结果 ─────────────────────────────────────────────────┐   │ │
│  │  │                                                              │   │ │
│  │  │  ========================================                   │   │ │
│  │  │  开始执行脚本...                                            │   │ │
│  │  │  ========================================                   │   │ │
│  │  │                                                              │   │ │
│  │  │  ========================================                   │   │ │
│  │  │  ✓ 脚本执行完成                                             │   │ │
│  │  │  ========================================                   │   │ │
│  │  │                                                              │   │ │
│  │  │  --- 标准输出 ---                                           │   │ │
│  │  │  ✓ 草稿创建成功: f71ad170-a32e-424d-895a-54cb8f1a1a70      │   │ │
│  │  │                                                              │   │ │
│  │  │  --- 执行结果 ---                                           │   │ │
│  │  │  draft_id = f71ad170-a32e-424d-895a-54cb8f1a1a70           │   │ │
│  │  │                                                            ▲ │   │ │
│  │  │                                                            █ │   │ │
│  │  │                                                            ▼ │   │ │
│  │  └──────────────────────────────────────────────────────────┘   │ │
│  │                                                                       │ │
│  │  状态栏: 执行完成                                                   │ │
│  └─────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─ 日志 ───────────────────────────────────────────────────────────────┐ │
│  │  [清空] [保存] ☑ 自动滚动                                            │ │
│  │  ─────────────────────────────────────────────────────────────────── │ │
│  │  2025-11-12 19:30:00 INFO - 开始执行脚本                             │ │
│  │  2025-11-12 19:30:01 INFO - 脚本执行完成                             │ │
│  │                                                                      ▲ │ │
│  │                                                                      █ │ │
│  │                                                                      ▼ │ │
│  └────────────────────────────────────────────────────────────────────── │ │
└───────────────────────────────────────────────────────────────────────────┘
```

## UI 组件说明

### 1. 顶部工具栏
```
[加载脚本...] - 从文件系统加载脚本文件
[清空]        - 清空脚本内容区域
[执行脚本]    - 执行当前脚本（带加载指示）
```

### 2. 脚本内容区域
- **占据约 60% 的垂直空间**
- 可滚动的文本编辑器
- 支持多行输入
- 等宽字体（Consolas, 10pt）
- 适合编写和查看代码

### 3. 执行结果区域
- **占据约 40% 的垂直空间**
- 只读文本区域
- 可滚动
- **颜色编码**：
  - 黑色：信息（INFO）
  - 绿色：成功（SUCCESS）
  - 红色：错误（ERROR）
  - 蓝色：输出（OUTPUT）

### 4. 状态栏
- 显示当前状态
- 可能的状态：
  - "就绪"
  - "正在执行..."
  - "执行完成"
  - "执行失败"

### 5. 主日志面板（底部）
- 显示所有应用程序日志
- 可折叠/展开
- 包含所有标签页的日志

## 执行流程的视觉反馈

### 状态 1：就绪状态
```
┌─ 脚本内容 ─────────────────┐
│                             │
│  (脚本代码)                 │
│                             │
└─────────────────────────────┘

[执行脚本] ← 按钮可点击

┌─ 执行结果 ─────────────────┐
│                             │
│  (空白或之前的结果)         │
│                             │
└─────────────────────────────┘

状态栏: 就绪
```

### 状态 2：执行中
```
┌─ 脚本内容 ─────────────────┐
│                             │
│  (脚本代码)                 │
│                             │
└─────────────────────────────┘

[执行脚本] ← 按钮禁用（灰色）

┌─ 执行结果 ─────────────────┐
│ ============================│
│ 开始执行脚本...             │
│ ============================│
│                             │
└─────────────────────────────┘

状态栏: 正在执行...
```

### 状态 3：执行完成（成功）
```
┌─ 脚本内容 ─────────────────┐
│                             │
│  (脚本代码)                 │
│                             │
└─────────────────────────────┘

[执行脚本] ← 按钮重新启用

┌─ 执行结果 ─────────────────┐
│ ============================│
│ ✓ 脚本执行完成 (绿色)       │
│ ============================│
│                             │
│ --- 标准输出 ---            │
│ ✓ 草稿创建成功... (蓝色)   │
│                             │
│ --- 执行结果 ---            │
│ draft_id = xxx (蓝色)       │
└─────────────────────────────┘

状态栏: 执行完成
```

### 状态 4：执行失败（错误）
```
┌─ 脚本内容 ─────────────────┐
│                             │
│  (脚本代码 - 可能有错误)    │
│                             │
└─────────────────────────────┘

[执行脚本] ← 按钮重新启用

┌─ 执行结果 ─────────────────┐
│ ============================│
│ ✗ 脚本执行失败 (红色)       │
│ ============================│
│                             │
│ Traceback (most recent call)│
│ File "<script>", line 5     │
│   ...                        │
│ NameError: name 'xxx' is not│
│ defined (红色)               │
└─────────────────────────────┘

状态栏: 执行失败

弹出对话框: "执行错误 - 脚本执行失败，
            请查看输出区域了解详情。"
```

## 交互示例

### 加载脚本文件

1. 点击 [加载脚本...] 按钮
2. 出现文件选择对话框：
   ```
   ┌─ 选择脚本文件 ────────────────────┐
   │                                    │
   │  查找位置: C:\Users\...            │
   │  ┌────────────────────────────┐   │
   │  │ 📁 Documents                │   │
   │  │ 📁 Downloads                │   │
   │  │ 📄 测试脚本_可执行版.py      │   │
   │  │ 📄 my_script.py             │   │
   │  │                             │   │
   │  └────────────────────────────┘   │
   │                                    │
   │  文件类型: 所有文件 (*.*)          │
   │           Python文件 (*.py)        │
   │           文本文件 (*.txt)         │
   │                                    │
   │        [打开]        [取消]        │
   └────────────────────────────────────┘
   ```
3. 选择文件后，脚本内容自动加载到编辑器
4. 执行结果区域显示：
   ```
   ✓ 已加载脚本: C:\Users\...\测试脚本_可执行版.py
   ```

### 清空脚本

1. 点击 [清空] 按钮
2. 如果有内容，出现确认对话框：
   ```
   ┌─ 确认 ─────────────┐
   │                     │
   │  确定要清空脚本内容  │
   │  吗？                │
   │                     │
   │   [是]      [否]    │
   └─────────────────────┘
   ```
3. 点击"是"后，脚本内容区域清空

## 颜色方案

### 执行结果区域
- **INFO（黑色）**：`#000000`
  - 分隔线
  - 标题
  - 一般信息

- **SUCCESS（绿色）**：`#008000`
  - "✓ 脚本执行完成"
  - "✓ 已加载脚本"
  - 成功消息

- **ERROR（红色）**：`#FF0000`
  - "✗ 脚本执行失败"
  - 错误堆栈跟踪
  - 异常信息

- **OUTPUT（蓝色）**：`#0000FF`
  - 脚本的 print 输出
  - 变量值
  - 执行结果

### 状态栏
- 普通文字：黑色
- 背景：浅灰色
- 边框：凹陷效果

## 响应式布局

### 窗口大小调整
- 脚本内容和执行结果区域按比例调整
- 水平宽度始终填满可用空间
- 垂直分割比例保持为 60%:40%

### 日志面板折叠
- 可以通过菜单"查看 > 切换日志面板"隐藏/显示
- 隐藏时释放空间给主工作区
- 显示时占据约 20% 的垂直空间

## 键盘快捷键（未来可能添加）

- `Ctrl+L` - 加载脚本
- `Ctrl+E` - 执行脚本
- `Ctrl+K` - 清空脚本
- `F5` - 执行脚本（快捷键）
- `Ctrl+Shift+C` - 清空输出

## 工具提示（Tooltip）

鼠标悬停在"脚本执行器"标签页上时显示：
```
┌────────────────────────────┐
│ 执行脚本并自动注入 API     │
│ 依赖项                     │
└────────────────────────────┘
```

这些视觉设计确保用户能够轻松理解和使用脚本执行器功能！
